# TrendBFfactor
sip FS BF解析5-a分析のためのプログラム

[Google Colab で開く](https://colab.research.google.com/github/tanidayasuo/TrendBFfactor/blob/main/TrendBFfactor.ipynb?hl=ja)


input.xlsxを入力にして、output.xlsxを出力するプログラムを作成。

１．input.xlsxの「クラス分け」シートと「配合表」シートを入力にして、output.xlsxの「クラス別配合表」を作成する。
　配合表の行には、時制ごとにTrendFactorが並び、列にはBFと呼ばれる変数がそのBFの強さの値をもって並んでいる。
　この表は、TrendFactorがクラス内で時制ごとにソートされている（本来性_、現状_、志向性_）。
 
２．次にoutput.xlsxの「クラス別配合表」から「クラス別配合時制別合計表」を作成する。
　クラスごとに本来性、現状、志向性の値の合計を出力する。
 
３．次にoutput.xlsxの「クラス別配合時制別合計表」から、クラス別時制別正規化配合表を作成する。
　BF合計には、クラス別時制のBF合計の平方根が入る。
　その右のBF変数の値は、元のBF変数の値をBF合計（の平方根）で割った値を入れる。

４.「クラス別時制別正規化配合表」から以下の処理を経て、サンプルにあるような「クラス別BFタイプ」を出力する。

10%未満は「0」

classごとに以下のFunctionによって、タイプ判定をする。

FunctionType( BFi(本来性）,BFi(現状),BFi(志向性) ):

BFi(本来性), BFi(現状), BFi(志向性)の値を比較して、
後続の条件により、指定のタイプを出力する

但し、
BFi：表頭の変数（サブライム、帰属回帰など）

i：クラスごとに1～10

A=Bの条件：A,BをBFi(？）としたとき、A=Bとする条件は、

    |A-B|＜0.1 or max(A,B)/min(A,B) < 1.5
    
　　とする。

タイプの判定条件は、上から評価

・BFi(本来性), BFi(現状), BFi(志向性)がすべてゼロならば、"none"

・BFi(本来性)がゼロではなく、BFi(現状), BFi(志向性)が共にゼロならば、"d0-1"

・BFi(志向性)がゼロではなく、BFi(本来性), BFi(現状)が共にゼロならば、"d0-2"

・BFi(現状)がゼロではなく、BFi(本来性), BFi(志向性)が共にゼロならば、"d0-3"

・BFi(現状)がゼロでかつ、BFi(本来性)＝BFi(志向性)ならば、"d1-eq"

・BFi(現状)がゼロでかつ、BFi(本来性)＞BFi(志向性)ならば、"d1->"

・BFi(現状)がゼロでかつ、BFi(本来性)＜BFi(志向性)ならば、"d1-<"

・BFi(本来性)がゼロでかつ、BFi(現状),BFi(志向性)共にゼロでないならば、"d2"

・BFi(志向性)がゼロでかつ、BFi(現状),BFi(本来性)共にゼロでないならば、"d3"

・そうでない、すなわち、BFi(本来性), BFi(現状), BFi(志向性)がすべてゼロではないならば、

　BFi(本来性)＝BFi(志向性)でかつ、BFi(現状)＝BFi(本来性)または、BFi(現状)＝BFi(志向性)ならば、"s1"
 
  BFi(本来性)＝BFi(志向性)でかつ、BFi(現状)＞BFi(本来性)または、BFi(現状)＞BFi(志向性)ならば、"s1"
  
  BFi(本来性)＜BFi(志向性)ならば、"d2"
  
  BFi(本来性)＞BFi(志向性)ならば、"d3"
